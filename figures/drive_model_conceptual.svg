<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 620" font-family="Helvetica Neue, Helvetica, Arial, sans-serif">
  <defs>
    <marker id="arrowBlack" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
    <marker id="arrowBlue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2563EB"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#DC2626"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#059669"/>
    </marker>
    <linearGradient id="sweepGrad" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#2563EB" stop-opacity="0.05"/>
      <stop offset="35%" stop-color="#2563EB" stop-opacity="0.25"/>
      <stop offset="50%" stop-color="#2563EB" stop-opacity="0.35"/>
      <stop offset="65%" stop-color="#2563EB" stop-opacity="0.25"/>
      <stop offset="100%" stop-color="#2563EB" stop-opacity="0.05"/>
    </linearGradient>
    <filter id="shadow" x="-5%" y="-5%" width="110%" height="110%">
      <feDropShadow dx="1" dy="1" stdDeviation="2" flood-opacity="0.1"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="960" height="620" fill="white"/>

  <!-- ============================================ -->
  <!-- PANEL A: Meiotic Drive Mechanism (left)      -->
  <!-- ============================================ -->
  <text x="160" y="32" font-size="14" font-weight="bold" fill="#1F2937" text-anchor="middle">A</text>
  <text x="190" y="32" font-size="13" font-weight="600" fill="#4B5563" text-anchor="start">Meiotic drive on the X chromosome</text>

  <!-- Precursor cell -->
  <ellipse cx="160" cy="80" rx="52" ry="28" fill="#F3F4F6" stroke="#9CA3AF" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="160" y="76" font-size="10" fill="#374151" text-anchor="middle" font-weight="600">Spermatocyte</text>
  <text x="160" y="89" font-size="9" fill="#6B7280" text-anchor="middle">(X + Y)</text>

  <!-- Division arrows -->
  <line x1="128" y1="108" x2="90" y2="145" stroke="#9CA3AF" stroke-width="1.5" marker-end="url(#arrowBlack)"/>
  <line x1="192" y1="108" x2="230" y2="145" stroke="#9CA3AF" stroke-width="1.5" marker-end="url(#arrowBlack)"/>
  <text x="160" y="130" font-size="8" fill="#9CA3AF" text-anchor="middle" font-style="italic">meiosis</text>

  <!-- X spermatid (active - larger, brighter) -->
  <ellipse cx="75" cy="175" rx="48" ry="26" fill="#DBEAFE" stroke="#2563EB" stroke-width="2" filter="url(#shadow)"/>
  <text x="75" y="171" font-size="10" fill="#1E40AF" text-anchor="middle" font-weight="700">X spermatid</text>
  <text x="75" y="184" font-size="9" fill="#2563EB" text-anchor="middle">gene ON ●</text>

  <!-- Y spermatid (silenced - smaller, dimmer) -->
  <ellipse cx="245" cy="175" rx="48" ry="26" fill="#FEF3C7" stroke="#D97706" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="245" y="171" font-size="10" fill="#92400E" text-anchor="middle" font-weight="700">Y spermatid</text>
  <text x="245" y="184" font-size="9" fill="#B45309" text-anchor="middle">gene OFF ○</text>

  <!-- MSCI escape annotation -->
  <rect x="25" y="210" rx="4" ry="4" width="260" height="42" fill="#EFF6FF" stroke="#BFDBFE" stroke-width="1"/>
  <text x="155" y="226" font-size="9" fill="#1E40AF" text-anchor="middle" font-weight="600">MSCI silences sex chromosomes during meiosis.</text>
  <text x="155" y="240" font-size="9" fill="#1E40AF" text-anchor="middle">Some X-linked genes escape → re-expressed in X spermatids.</text>

  <!-- Drive arrow (X wins) -->
  <path d="M 75 201 Q 75 270, 160 280" stroke="#059669" stroke-width="2" fill="none" marker-end="url(#arrowGreen)" stroke-dasharray="6,3"/>
  <text x="60" y="260" font-size="9" fill="#059669" font-weight="600" transform="rotate(-20, 60, 260)">Transmission</text>
  <text x="65" y="272" font-size="9" fill="#059669" font-weight="600" transform="rotate(-20, 65, 272)">advantage</text>

  <!-- Suppression arrow (Y loses) -->
  <path d="M 245 201 Q 245 260, 175 280" stroke="#DC2626" stroke-width="1.5" fill="none" marker-end="url(#arrowRed)" stroke-dasharray="4,3" opacity="0.7"/>
  <text x="250" y="258" font-size="8" fill="#DC2626" font-style="italic" transform="rotate(15, 250, 258)">suppressed</text>

  <!-- Result: biased segregation -->
  <rect x="105" y="275" rx="10" ry="10" width="110" height="26" fill="#D1FAE5" stroke="#059669" stroke-width="1.5"/>
  <text x="160" y="292" font-size="9.5" fill="#065F46" text-anchor="middle" font-weight="700">Meiotic drive</text>

  <!-- Transient note -->
  <rect x="20" y="310" rx="4" ry="4" width="280" height="52" fill="#FFF7ED" stroke="#FDBA74" stroke-width="1"/>
  <text x="160" y="326" font-size="8.5" fill="#9A3412" text-anchor="middle" font-weight="600">Drive is transient — not a steady-state distortion.</text>
  <text x="160" y="340" font-size="8.5" fill="#9A3412" text-anchor="middle">Flares on specific Y/autosomal backgrounds, pushes</text>
  <text x="160" y="353" font-size="8.5" fill="#9A3412" text-anchor="middle">driver to high frequency, then subsides. Detected via</text>
  <!-- <text x="160" y="366" font-size="8.5" fill="#9A3412" text-anchor="middle">evolutionary signatures, not contemporary sex ratios.</text> -->

  <!-- ============================================ -->
  <!-- PANEL B: The Conflict (center)               -->
  <!-- ============================================ -->
  <line x1="320" y1="20" x2="320" y2="590" stroke="#E5E7EB" stroke-width="1" stroke-dasharray="4,4"/>

  <text x="490" y="32" font-size="14" font-weight="bold" fill="#1F2937" text-anchor="middle">B</text>
  <text x="520" y="32" font-size="13" font-weight="600" fill="#4B5563" text-anchor="start">The neuron / spermatid conflict</text>

  <!-- Central gene box -->
  <rect x="435" y="60" rx="8" ry="8" width="130" height="40" fill="#F3F4F6" stroke="#6B7280" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="500" y="78" font-size="10" fill="#374151" text-anchor="middle" font-weight="700">Dual-function gene</text>
  <text x="500" y="91" font-size="8.5" fill="#6B7280" text-anchor="middle">expressed in testis AND brain</text>

  <!-- Arrow to spermatid (left, beneficial) -->
  <line x1="435" y1="85" x2="365" y2="120" stroke="#059669" stroke-width="2" marker-end="url(#arrowGreen)"/>

  <!-- Spermatid context -->
  <rect x="335" y="115" rx="6" ry="6" width="80" height="60" fill="#D1FAE5" stroke="#059669" stroke-width="1.5"/>
  <!-- Simple sperm icon -->
  <ellipse cx="375" cy="135" rx="8" ry="6" fill="#059669" opacity="0.3"/>
  <line x1="383" y1="135" x2="400" y2="140" stroke="#059669" stroke-width="1.5" opacity="0.3"/>
  <text x="375" y="158" font-size="8.5" fill="#065F46" text-anchor="middle" font-weight="600">Spermatid</text>
  <text x="375" y="168" font-size="8" fill="#065F46" text-anchor="middle">Advantage ✓</text>

  <!-- Arrow to neuron (right, harmful) -->
  <line x1="565" y1="85" x2="615" y2="120" stroke="#DC2626" stroke-width="2" marker-end="url(#arrowRed)"/>

  <!-- Neuron context -->
  <rect x="585" y="115" rx="6" ry="6" width="80" height="60" fill="#FEE2E2" stroke="#DC2626" stroke-width="1.5"/>
  <!-- Simple neuron icon -->
  <circle cx="625" cy="135" r="6" fill="#DC2626" opacity="0.2"/>
  <line x1="619" y1="135" x2="605" y2="128" stroke="#DC2626" stroke-width="1" opacity="0.3"/>
  <line x1="619" y1="135" x2="605" y2="142" stroke="#DC2626" stroke-width="1" opacity="0.3"/>
  <line x1="631" y1="135" x2="645" y2="130" stroke="#DC2626" stroke-width="1" opacity="0.3"/>
  <text x="625" y="158" font-size="8.5" fill="#991B1B" text-anchor="middle" font-weight="600">Neuron</text>
  <text x="625" y="168" font-size="8" fill="#991B1B" text-anchor="middle">ASD risk ✗</text>

  <!-- Overlap statistic -->
  <rect x="355" y="195" rx="4" ry="4" width="290" height="34" fill="#EFF6FF" stroke="#BFDBFE" stroke-width="1"/>
  <text x="500" y="210" font-size="9" fill="#1E40AF" text-anchor="middle">~25% of neuron genes also expressed in spermatids.</text>
  <text x="500" y="222" font-size="9" fill="#1E40AF" text-anchor="middle">X chromosome carries 20% of ASD-relevant neuro-variation.</text>

  <!-- Triple overlap genes -->
  <text x="500" y="255" font-size="10" fill="#374151" text-anchor="middle" font-weight="700">Five genes in triple overlap:</text>
  <text x="500" y="270" font-size="9" fill="#374151" text-anchor="middle">ASD-associated × under positive selection × X/Y spermatid DEG</text>

  <!-- Gene boxes -->
  <rect x="348" y="282" rx="4" ry="4" width="56" height="22" fill="#DBEAFE" stroke="#2563EB" stroke-width="1"/>
  <text x="376" y="297" font-size="9" fill="#1E40AF" text-anchor="middle" font-weight="600">CDKL5</text>

  <rect x="410" y="282" rx="4" ry="4" width="52" height="22" fill="#DBEAFE" stroke="#2563EB" stroke-width="1"/>
  <text x="436" y="297" font-size="9" fill="#1E40AF" text-anchor="middle" font-weight="600">CLCN4</text>

  <rect x="468" y="282" rx="4" ry="4" width="56" height="22" fill="#DBEAFE" stroke="#2563EB" stroke-width="1"/>
  <text x="496" y="297" font-size="9" fill="#1E40AF" text-anchor="middle" font-weight="600">HUWE1</text>

  <rect x="530" y="282" rx="4" ry="4" width="64" height="22" fill="#DBEAFE" stroke="#2563EB" stroke-width="1"/>
  <text x="562" y="297" font-size="9" fill="#1E40AF" text-anchor="middle" font-weight="600">IL1RAPL1</text>

  <rect x="600" y="282" rx="4" ry="4" width="56" height="22" fill="#DBEAFE" stroke="#2563EB" stroke-width="1"/>
  <text x="628" y="297" font-size="9" fill="#1E40AF" text-anchor="middle" font-weight="600">PTCHD1</text>

  <!-- p-value -->
  <text x="500" y="320" font-size="8.5" fill="#6B7280" text-anchor="middle" font-style="italic">Triple overlap: p = 5.95 × 10⁻⁵</text>

  <!-- ============================================ -->
  <!-- PANEL C: Evolutionary Consequence (bottom)   -->
  <!-- ============================================ -->
  <line x1="330" y1="345" x2="960" y2="345" stroke="#E5E7EB" stroke-width="1" stroke-dasharray="4,4"/>

  <text x="490" y="370" font-size="14" font-weight="bold" fill="#1F2937" text-anchor="middle">C</text>
  <text x="520" y="370" font-size="13" font-weight="600" fill="#4B5563" text-anchor="start">Hitchhiking inflates ASD variant frequencies</text>

  <!-- Chromosome bar -->
  <rect x="360" y="395" rx="6" ry="6" width="280" height="18" fill="#F3F4F6" stroke="#D1D5DB" stroke-width="1"/>
  <text x="350" y="408" font-size="8" fill="#6B7280" text-anchor="end">X chromosome</text>

  <!-- Sweep region highlight -->
  <rect x="445" y="393" rx="3" ry="3" width="100" height="22" fill="url(#sweepGrad)"/>

  <!-- Driver gene (star) -->
  <polygon points="495,398 498,405 506,405 500,410 502,418 495,413 488,418 490,410 484,405 492,405" fill="#2563EB" stroke="#1E40AF" stroke-width="0.5"/>
  <text x="495" y="434" font-size="8.5" fill="#1E40AF" text-anchor="middle" font-weight="700">Driver gene</text>

  <!-- ASD risk variants (triangles) nearby -->
  <polygon points="460,404 463,398 466,404" fill="#DC2626" stroke="#991B1B" stroke-width="0.5"/>
  <polygon points="475,404 478,398 481,404" fill="#DC2626" stroke="#991B1B" stroke-width="0.5"/>
  <polygon points="515,404 518,398 521,404" fill="#DC2626" stroke="#991B1B" stroke-width="0.5"/>
  <polygon points="530,404 533,398 536,404" fill="#DC2626" stroke="#991B1B" stroke-width="0.5"/>
  <text x="460" y="434" font-size="7.5" fill="#DC2626" text-anchor="middle">▲ ASD</text>
  <text x="460" y="443" font-size="7.5" fill="#DC2626" text-anchor="middle">variants</text>

  <!-- Distant variants (unaffected) -->
  <polygon points="390,404 393,398 396,404" fill="#D1D5DB" stroke="#9CA3AF" stroke-width="0.5"/>
  <polygon points="610,404 613,398 616,404" fill="#D1D5DB" stroke="#9CA3AF" stroke-width="0.5"/>

  <!-- Frequency elevation diagram -->
  <text x="500" y="470" font-size="9" fill="#374151" text-anchor="middle" font-weight="600">Allele frequency before vs after sweep:</text>

  <!-- Before bar chart -->
  <text x="420" y="490" font-size="8" fill="#6B7280" text-anchor="middle">Before</text>
  <rect x="395" y="493" rx="2" ry="2" width="12" height="30" fill="#FCA5A5" stroke="#DC2626" stroke-width="0.5"/>
  <rect x="411" y="500" rx="2" ry="2" width="12" height="23" fill="#FCA5A5" stroke="#DC2626" stroke-width="0.5"/>
  <rect x="427" y="505" rx="2" ry="2" width="12" height="18" fill="#FCA5A5" stroke="#DC2626" stroke-width="0.5"/>
  <!-- baseline -->
  <line x1="392" y1="523" x2="442" y2="523" stroke="#9CA3AF" stroke-width="0.5"/>

  <!-- Arrow between -->
  <line x1="455" y1="507" x2="485" y2="507" stroke="#374151" stroke-width="1.5" marker-end="url(#arrowBlack)"/>
  <text x="470" y="500" font-size="7.5" fill="#374151" text-anchor="middle">sweep</text>

  <!-- After bar chart (taller = inflated frequencies) -->
  <text x="540" y="490" font-size="8" fill="#6B7280" text-anchor="middle">After</text>
  <rect x="510" y="483" rx="2" ry="2" width="12" height="40" fill="#DC2626" stroke="#991B1B" stroke-width="0.5"/>
  <rect x="526" y="488" rx="2" ry="2" width="12" height="35" fill="#DC2626" stroke="#991B1B" stroke-width="0.5"/>
  <rect x="542" y="493" rx="2" ry="2" width="12" height="30" fill="#DC2626" stroke="#991B1B" stroke-width="0.5"/>
  <!-- baseline -->
  <line x1="507" y1="523" x2="557" y2="523" stroke="#9CA3AF" stroke-width="0.5"/>

  <!-- Labels for frequency -->
  <text x="395" y="540" font-size="7" fill="#9CA3AF">low freq</text>
  <text x="510" y="540" font-size="7" fill="#9CA3AF">inflated freq</text>

  <!-- Arrow to consequence -->
  <line x1="560" y1="510" x2="600" y2="510" stroke="#374151" stroke-width="1.5" marker-end="url(#arrowBlack)"/>

  <!-- Consequence box -->
  <rect x="605" y="480" rx="8" ry="8" width="185" height="60" fill="#FEF2F2" stroke="#DC2626" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="697" y="500" font-size="9.5" fill="#991B1B" text-anchor="middle" font-weight="700">Elevated population</text>
  <text x="697" y="514" font-size="9.5" fill="#991B1B" text-anchor="middle" font-weight="700">ASD risk burden</text>
  <text x="697" y="530" font-size="8" fill="#B91C1C" text-anchor="middle">Maintained by evolutionary</text>
  <!-- <text x="697" y="542" font-size="8" fill="#B91C1C" text-anchor="middle">"pump" despite negative selection</text> -->

  <!-- ============================================ -->
  <!-- PANEL D: Y sink model (bottom left)          -->
  <!-- ============================================ -->
  <line x1="20" y1="375" x2="320" y2="375" stroke="#E5E7EB" stroke-width="1" stroke-dasharray="4,4"/>

  <text x="30" y="400" font-size="14" font-weight="bold" fill="#1F2937" text-anchor="middle">D</text>
  <text x="60" y="400" font-size="13" font-weight="600" fill="#4B5563" text-anchor="start">Y heterochromatin sink</text>

  <!-- Y chromosome with heterochromatin (haplogroup I - large) -->
  <rect x="40" y="420" rx="5" ry="5" width="110" height="20" fill="#FEF3C7" stroke="#D97706" stroke-width="1.5"/>
  <!-- heterochromatin blocks -->
  <rect x="52" y="422" rx="2" ry="2" width="20" height="16" fill="#D97706" opacity="0.5"/>
  <rect x="76" y="422" rx="2" ry="2" width="25" height="16" fill="#D97706" opacity="0.5"/>
  <rect x="108" y="422" rx="2" ry="2" width="18" height="16" fill="#D97706" opacity="0.5"/>
  <rect x="130" y="422" rx="2" ry="2" width="14" height="16" fill="#D97706" opacity="0.5"/>
  <text x="95" y="458" font-size="8.5" fill="#92400E" text-anchor="middle" font-weight="600">Haplogroup I</text>
  <text x="95" y="469" font-size="8" fill="#B45309" text-anchor="middle">More heterochromatin</text>

  <!-- Y chromosome (haplogroup R - small heterochromatin) -->
  <rect x="185" y="420" rx="5" ry="5" width="110" height="20" fill="#FEF3C7" stroke="#D97706" stroke-width="1.5"/>
  <!-- fewer heterochromatin blocks -->
  <rect x="200" y="422" rx="2" ry="2" width="12" height="16" fill="#D97706" opacity="0.3"/>
  <rect x="240" y="422" rx="2" ry="2" width="10" height="16" fill="#D97706" opacity="0.3"/>
  <text x="240" y="458" font-size="8.5" fill="#92400E" text-anchor="middle" font-weight="600">Haplogroup R</text>
  <text x="240" y="469" font-size="8" fill="#B45309" text-anchor="middle">Less heterochromatin</text>

  <!-- Arrows showing protein sequestration -->
  <text x="95" y="490" font-size="7.5" fill="#6B7280" text-anchor="middle">HP1, SUV39H</text>
  <text x="95" y="500" font-size="7.5" fill="#6B7280" text-anchor="middle">sequestered →</text>

  <!-- Consequence boxes -->
  <rect x="30" y="508" rx="4" ry="4" width="130" height="38" fill="#FEE2E2" stroke="#DC2626" stroke-width="1"/>
  <text x="95" y="522" font-size="8" fill="#991B1B" text-anchor="middle" font-weight="600">Weakened boundaries</text>
  <text x="95" y="534" font-size="8" fill="#991B1B" text-anchor="middle">→ risk variants exposed</text>

  <rect x="175" y="508" rx="4" ry="4" width="130" height="38" fill="#D1FAE5" stroke="#059669" stroke-width="1"/>
  <text x="240" y="522" font-size="8" fill="#065F46" text-anchor="middle" font-weight="600">Intact boundaries</text>
  <text x="240" y="534" font-size="8" fill="#065F46" text-anchor="middle">→ risk variants silenced</text>

  <!-- Bottom note -->
  <rect x="30" y="555" rx="4" ry="4" width="275" height="30" fill="#F3F4F6" stroke="#D1D5DB" stroke-width="1"/>
  <text x="168" y="570" font-size="8" fill="#6B7280" text-anchor="middle" font-style="italic">Different GWAS hits in haplogroup I vs R males</text>
  <text x="168" y="581" font-size="8" fill="#6B7280" text-anchor="middle" font-style="italic">= Y-mediated epistasis (invisible to standard GWAS)</text>

  <!-- ============================================ -->
  <!-- Connecting arrow: A→B                        -->
  <!-- ============================================ -->
  <path d="M 290 290 Q 320 320, 370 280" stroke="#6B7280" stroke-width="1.5" fill="none" marker-end="url(#arrowBlack)" stroke-dasharray="5,3"/>

  <!-- ============================================ -->
  <!-- Connecting arrow: B→C                        -->
  <!-- ============================================ -->
  <path d="M 500 325 L 500 385" stroke="#6B7280" stroke-width="1.5" fill="none" marker-end="url(#arrowBlack)" stroke-dasharray="5,3"/>

  <!-- Legend at very bottom -->
  <rect x="360" y="568" rx="4" ry="4" width="420" height="42" fill="#F9FAFB" stroke="#E5E7EB" stroke-width="1"/>
  <polygon points="375,582 378,576 381,582" fill="#DC2626"/>
  <text x="388" y="583" font-size="7.5" fill="#374151">ASD risk variant</text>
  <polygon points="445,582 448,576 451,576 454,582 451,588 448,588" fill="#2563EB" stroke="#1E40AF" stroke-width="0.3"/>
  <text x="460" y="583" font-size="7.5" fill="#374151">Driver gene</text>
  <rect x="520" y="576" width="14" height="10" fill="#D97706" opacity="0.5" rx="2"/>
  <text x="540" y="583" font-size="7.5" fill="#374151">Heterochromatin</text>
  <rect x="620" y="576" width="40" height="10" fill="url(#sweepGrad)" rx="2" stroke="#2563EB" stroke-width="0.3"/>
  <text x="666" y="583" font-size="7.5" fill="#374151">Selective sweep</text>

  <text x="500" y="602" font-size="7" fill="#9CA3AF" text-anchor="middle">Hypothesised model: selfish X-linked genes drive ASD-relevant variation through hitchhiking; Y heterochromatin modulates variant exposure via epistasis.</text>
</svg>